/* ==========================================================================
   Mobile Responsive Overrides (Max Width: 768px)
   ========================================================================== */
@media (max-width: 768px) {

    /* 1. Layout Adjustments */
    .app-wrapper {
        flex-direction: column;
        padding-bottom: 70px;
        /* Space for Bottom Nav */
        min-height: auto;
        /* Allow scrolling */
    }

    /* Hide Desktop Sidebar */
    .sidebar {
        display: none !important;
    }

    /* Full Width Content */
    .main-content,
    .sidebar.collapsed+.main-content {
        margin-left: 0 !important;
        width: 100% !important;
        padding: 0;
    }

    /* Header Overhaul */
    .global-status-bar {
        position: sticky;
        top: 0;
        z-index: 100;
        padding: 0 1rem;
        height: 56px;
        /* Standard Mobile Header */
        justify-content: center;
        /* Center Title */
    }

    .status-bar-left {
        width: 100%;
        justify-content: center;
    }

    .status-bar-right {
        display: none;
        /* Hide desktop stats in header */
    }

    .section-title {
        font-size: 1.1rem;
        text-align: center;
    }

    /* Content Area Padding */
    .content-area {
        padding: 1rem;
        /* Reduced padding */
    }

    /* --- Bottom Navigation --- */
    .bottom-nav {
        display: flex !important;
        justify-content: space-between;
        align-items: center;
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background: rgba(15, 23, 42, 0.95);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        padding: 0.75rem 0.5rem;
        /* Increased padding slightly for safe area */
        z-index: 1000;
        border-top: 1px solid rgba(255, 255, 255, 0.05);
        box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.3);
    }

    .bottom-nav-item {
        color: var(--text-muted);
        text-decoration: none;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 0.25rem;
        flex: 1;
    }

    .bottom-nav-item .material-icons {
        font-size: 1.5rem;
        transition: color 0.2s;
    }

    .bottom-nav-item span {
        font-size: 0.7rem;
        font-weight: 500;
    }

    .bottom-nav-item.active {
        color: var(--primary);
    }

    .bottom-nav-item:active {
        transform: scale(0.95);
    }

    /* Center Logo in Nav */
    .bottom-nav-center-logo {
        position: relative;
        top: -15px;
        /* Pull up to float */
        background: var(--bg-card);
        border-radius: 50%;
        padding: 6px;
        /* Inner padding */
        border: 1px solid var(--border-color);
        box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.2);
        overflow: hidden;
        /* Clip image */
    }

    .bottom-nav-center-logo img {
        height: 60px;
        width: 60px;
        /* Force square for circle mask */
        object-fit: cover;
        display: block;
        border-radius: 50%;
        /* Ensure image is circle */
        transition: transform 0.2s;
    }

    .bottom-nav-center-logo:active {
        transform: scale(0.95);
    }

    /* --- Toolbar Adjustments (Downloads Page) --- */
    /* Use !important to override inline styles in downloads.html */
    .elegant-toolbar {
        flex-direction: column !important;
        align-items: stretch !important;
        gap: 1rem !important;
        height: auto !important;
        padding: 1rem !important;
        box-shadow: none !important;
        margin-bottom: 1rem !important;
    }

    .search-wrapper {
        width: 100% !important;
        max-width: 100% !important;
        margin: 0 !important;
    }

    .action-group {
        width: 100%;
        justify-content: space-between;
    }

    .elegant-search-input {
        width: 100% !important;
    }

    /* --- Downloads Table to Card View (Full List) --- */
    #downloads-full-list {
        display: flex;
        flex-direction: column;
        gap: 1rem;
    }

    .download-table {
        display: block;
        /* Break table */
    }

    .download-table thead {
        display: none !important;
    }

    /* Row Card Style */
    #downloads-full-list tr,
    .download-table tr {
        display: grid !important;
        /* Force Grid */
        grid-template-areas:
            "checkbox name name name"
            "progress progress progress progress"
            "status speed eta size"
            "category added . .";
        grid-template-columns: 30px 1fr 1fr 1fr;
        gap: 0.5rem;
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: 12px;
        padding: 1rem;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        position: relative;
        height: auto !important;
        margin-bottom: 0.5rem;
    }

    .download-table td {
        display: block;
        border: none;
        padding: 0 !important;
        height: auto !important;
        text-align: left !important;
    }

    /* Cell Mapping */
    /* Checkbox */
    .mui-head-cell.checkbox-cell,
    .download-table td.checkbox-cell {
        grid-area: checkbox;
        width: auto !important;
        max-width: none !important;
        min-width: auto !important;
        align-self: center;
    }

    /* Name */
    .cell-name {
        grid-area: name;
        font-weight: 700;
        font-size: 0.95rem;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
        align-self: center;
    }

    .download-name {
        font-size: 1rem !important;
    }

    /* Progress */
    .cell-progress {
        grid-area: progress;
        width: 100%;
        margin: 0.5rem 0;
    }

    .linear-progress {
        height: 6px;
    }

    /* Stats Row */
    .cell-status {
        grid-area: status;
    }

    .cell-speed {
        grid-area: speed;
        color: var(--primary);
        font-weight: 700;
        font-size: 0.8rem;
        justify-self: center;
    }

    .cell-eta {
        grid-area: eta;
        color: var(--text-muted);
        font-size: 0.8rem;
        justify-self: center;
    }

    .cell-size {
        grid-area: size;
        color: var(--text-muted);
        font-size: 0.8rem;
        justify-self: end;
    }

    .cell-category {
        grid-area: category;
        align-self: end;
        opacity: 0.7;
        font-size: 0.7rem;
    }

    .cell-date {
        grid-area: added;
        align-self: center;
        opacity: 0.7;
        font-size: 0.7rem;
    }

    /* Hide empty cells or desktop specific fillers if any */
    .download-table tr td:empty {
        display: none;
    }

    /* --- Footer Hiding --- */
    .downloads-container tfoot,
    .download-table tfoot {
        display: none !important;
    }

    /* --- Search Page Fixes --- */
    .filter-section {
        overflow-x: auto !important;
        white-space: nowrap;
        padding-bottom: 0.5rem;
        -webkit-overflow-scrolling: touch;
        margin-bottom: 1rem;
        display: flex;
        gap: 0.5rem;
    }

    .filter-group {
        display: inline-flex;
        margin-right: 0;
    }

    /* --- Settings Page Fixes --- */
    .settings-tabs-header {
        overflow-x: auto !important;
        white-space: nowrap;
        padding-bottom: 0.5rem;
        margin-bottom: 1rem;
        -webkit-overflow-scrolling: touch;
        display: flex !important;
        gap: 0.5rem !important;
    }

    .tab-btn {
        flex: 0 0 auto;
    }

    /* Account Card Studio Layout Fix */
    .account-cell {
        flex-direction: column;
        align-items: flex-start !important;
    }

    .account-meta {
        margin-left: 0 !important;
    }

    /* Downloads Settings Form Stacking */
    .settings-card .form-group {
        flex-direction: column !important;
        align-items: flex-start !important;
    }

    .category-paths .category-row {
        flex-direction: column !important;
        align-items: flex-start !important;
        gap: 0.25rem !important;
    }

    .category-label {
        width: 100%;
        margin-bottom: 0.25rem;
    }

    /* Split Concurrent/Speed Row */
    .settings-card .form-row {
        flex-direction: column !important;
        gap: 1rem !important;
        align-items: stretch !important;
    }

    .settings-card .form-row .form-group {
        width: 100% !important;
    }

    /* Stats Card (Dashboard) */
    .stats-card {
        height: auto !important;
        text-align: left !important;
    }

    .stats-grid {
        grid-template-columns: 1fr !important;
        gap: 1rem !important;
    }

    /* --- Minified Queue Card View (Mobile) --- */
    .minified-list-header {
        display: none !important;
    }

    .minified-list-grid.minified-item {
        display: grid;
        grid-template-areas:
            "name name"
            "status status"
            "size speed";
        grid-template-columns: 1fr 1fr;
        gap: 0.5rem;
        padding: 1rem;
        background: var(--bg-card);
        border: 1px solid var(--border-color);
        border-radius: 8px;
        margin-bottom: 0.5rem;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    }

    .minified-item .name-col {
        grid-area: name;
        font-weight: 700;
        font-size: 0.95rem;
        width: 100%;
        margin-bottom: 0.25rem;
        padding-right: 0 !important;
    }

    .minified-item .status-col {
        grid-area: status;
        width: 100%;
    }

    .minified-item .size-col {
        grid-area: size;
        text-align: left !important;
        font-size: 0.8rem;
    }

    .minified-item .speed-col {
        grid-area: speed;
        text-align: right !important;
        font-size: 0.8rem;
        color: var(--primary);
    }
}