import{h as s,j as i,k as n,i as o}from"./BNLZGSLr.js";import{t as a}from"./Kudn4uhO.js";class l{#e=s(0);get currentStep(){return i(this.#e)}set currentStep(e){n(this.#e,e,!0)}#t=s(!1);get isComplete(){return i(this.#t)}set isComplete(e){n(this.#t,e,!0)}#a=s(!1);get isLoading(){return i(this.#a)}set isLoading(e){n(this.#a,e,!0)}#r=s(o({fshareEmail:"",fsharePassword:"",downloadPath:"/downloads",maxConcurrent:3,sonarrEnabled:!1,sonarrUrl:"http://localhost:8989",sonarrApiKey:"",radarrEnabled:!1,radarrUrl:"http://localhost:7878",radarrApiKey:"",jellyfinEnabled:!1,jellyfinUrl:"http://localhost:8096",jellyfinApiKey:""}));get data(){return i(this.#r)}set data(e){n(this.#r,e,!0)}#s=s(!1);get fshareValidated(){return i(this.#s)}set fshareValidated(e){n(this.#s,e,!0)}#i=s(!1);get sonarrValidated(){return i(this.#i)}set sonarrValidated(e){n(this.#i,e,!0)}#n=s(!1);get radarrValidated(){return i(this.#n)}set radarrValidated(e){n(this.#n,e,!0)}#o=s(!1);get jellyfinValidated(){return i(this.#o)}set jellyfinValidated(e){n(this.#o,e,!0)}async checkStatus(){try{const e=await fetch("/api/setup/status");if(e.ok){const t=await e.json();return this.isComplete=t.complete,t.complete}}catch(e){console.error("Failed to check setup status:",e)}return!1}async validateFshare(){this.isLoading=!0;try{const e=await fetch("/api/setup/fshare",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:this.data.fshareEmail,password:this.data.fsharePassword})});if(e.ok){const t=await e.json();return t.success?(this.fshareValidated=!0,a.success("FShare account connected successfully!"),!0):(a.error(t.message||"Invalid credentials"),!1)}}catch(e){a.error("Failed to connect to FShare"),console.error("FShare validation error:",e)}finally{this.isLoading=!1}return!1}async testSonarr(){this.isLoading=!0;try{const e=await fetch("/api/setup/sonarr/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:this.data.sonarrUrl,api_key:this.data.sonarrApiKey})});if(e.ok){const t=await e.json();if(t.success){this.sonarrValidated=!0;const r=t.version?`Connected to Sonarr v${t.version}`:"Connected to Sonarr";return a.success(r),!0}else return a.error(t.message||"Connection failed"),!1}}catch(e){a.error("Failed to connect to Sonarr"),console.error("Sonarr test error:",e)}finally{this.isLoading=!1}return!1}async testRadarr(){this.isLoading=!0;try{const e=await fetch("/api/setup/radarr/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:this.data.radarrUrl,api_key:this.data.radarrApiKey})});if(e.ok){const t=await e.json();if(t.success){this.radarrValidated=!0;const r=t.version?`Connected to Radarr v${t.version}`:"Connected to Radarr";return a.success(r),!0}else return a.error(t.message||"Connection failed"),!1}}catch(e){a.error("Failed to connect to Radarr"),console.error("Radarr test error:",e)}finally{this.isLoading=!1}return!1}async testJellyfin(){this.isLoading=!0;try{const e=await fetch("/api/setup/jellyfin/test",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:this.data.jellyfinUrl,api_key:this.data.jellyfinApiKey})});if(e.ok){const t=await e.json();if(t.success){this.jellyfinValidated=!0;const r=t.version?`Connected to Jellyfin v${t.version}`:"Connected to Jellyfin";return a.success(r),!0}else return a.error(t.message||"Connection failed"),!1}}catch(e){a.error("Failed to connect to Jellyfin"),console.error("Jellyfin test error:",e)}finally{this.isLoading=!1}return!1}async completeSetup(){this.isLoading=!0;try{const e={fshare:{email:this.data.fshareEmail,password:this.data.fsharePassword},downloads:{directory:this.data.downloadPath,max_concurrent:this.data.maxConcurrent}};this.data.sonarrEnabled&&this.sonarrValidated&&(e.sonarr={url:this.data.sonarrUrl,api_key:this.data.sonarrApiKey}),this.data.radarrEnabled&&this.radarrValidated&&(e.radarr={url:this.data.radarrUrl,api_key:this.data.radarrApiKey}),this.data.jellyfinEnabled&&this.jellyfinValidated&&(e.jellyfin={url:this.data.jellyfinUrl,api_key:this.data.jellyfinApiKey});const t=await fetch("/api/setup/complete",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(t.ok){const r=await t.json();return r.success?(this.isComplete=!0,a.success("Setup completed successfully!"),!0):(a.error(r.message||"Failed to complete setup"),!1)}}catch(e){a.error("Failed to complete setup"),console.error("Complete setup error:",e)}finally{this.isLoading=!1}return!1}nextStep(){this.currentStep<4&&this.currentStep++}prevStep(){this.currentStep>0&&this.currentStep--}goToStep(e){e>=0&&e<=4&&(this.currentStep=e)}reset(){this.currentStep=0,this.isComplete=!1,this.fshareValidated=!1,this.sonarrValidated=!1,this.radarrValidated=!1,this.jellyfinValidated=!1}}const f=new l;export{f as s};
