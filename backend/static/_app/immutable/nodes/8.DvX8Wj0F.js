import"../chunks/DsnmJJEf.js";import{b as qa,o as ya,s as y}from"../chunks/CpQGpjHh.js";import{p as wa,h as f,i as fe,a as n,b as Sa,e as xa,c,k as v,j as e,ag as Ta,d as l,r,a9 as W,f as N,s as d,a7 as ka,t as T}from"../chunks/DkP3IR00.js";import{i as p}from"../chunks/DRm4gdwb.js";import{t as X,b as j,f as Ve,e as _e,c as he,s as Ae,a as ge}from"../chunks/Bx19YLT4.js";import{h as Da}from"../chunks/B5XdgsWK.js";import{d as Ea,s as Ba}from"../chunks/ysiDY0Qf.js";import{s as Le}from"../chunks/DPsHQfHC.js";import{u as Pa}from"../chunks/g_HMU8FS.js";import{S as Qe}from"../chunks/D8kBj3AC.js";class Fa{cache=new Map;staleTime=300*1e3;async fetch(w,G){const k=Date.now(),b=this.cache.get(w);if(b&&k-b.timestamp<this.staleTime)return console.log(`[QueryStore] Cache hit for ${w}`),b.data;console.log(`[QueryStore] Fetching ${w}`);const D=await G();return this.cache.set(w,{data:D,timestamp:k}),D}invalidate(w){this.cache.delete(w)}}const Ke=new Fa;var Ma=c('<div class="loading-container svelte-e12qt1"><div class="loading-spinner"></div> <p>Synchronizing with Fshare API...</p></div>'),Ca=c("<div><!></div>"),Ia=c('<div class="trending-section svelte-e12qt1"><div class="hero-header svelte-e12qt1"><div class="icon-ring-small svelte-e12qt1"><span class="material-icons">local_fire_department</span></div> <div><h2>Trending on Fshare</h2> <p class="subtitle svelte-e12qt1">Popular files discovered across the network today</p></div></div> <div class="search-results-grid svelte-e12qt1"></div></div>'),za=c('<div class="empty-state svelte-e12qt1"><span class="material-icons svelte-e12qt1">search_off</span> <h3>NO MATCHES FOUND</h3> <p>Broaden your search parameters or check title spelling.</p></div>'),Ua=c("<div><!></div>"),Ra=c('<div class="search-results-grid svelte-e12qt1"></div>'),Va=c('<img alt="" loading="lazy" class="svelte-e12qt1"/>'),Aa=c('<img alt="" loading="lazy" class="svelte-e12qt1"/>'),La=c('<div class="placeholder svelte-e12qt1"><span class="material-icons">movie</span></div>'),Qa=c('<span class="badge res svelte-e12qt1"> </span>'),Ka=c('<span class="badge src svelte-e12qt1"> </span>'),Na=c('<span class="badge episode svelte-e12qt1"> </span>'),ja=c('<span class="badge sub svelte-e12qt1">VIETSUB</span>'),Ga=c('<span class="badge dub svelte-e12qt1">VIETDUB</span>'),Ha=c('<button class="action-btn-icon pulse svelte-e12qt1" title="Smart Search"><span class="material-icons">psychology</span></button>'),$a=c('<div class="result-list-item glass-panel svelte-e12qt1"><div class="item-visual svelte-e12qt1"><!></div> <div class="item-main svelte-e12qt1"><div class="item-title-row svelte-e12qt1"><h3 class="title svelte-e12qt1"> </h3> <span class="year svelte-e12qt1"> </span></div> <div class="filename svelte-e12qt1"> </div> <div class="item-meta svelte-e12qt1"><!> <!> <!> <span class="size svelte-e12qt1"> </span> <!> <!></div></div> <div class="item-actions svelte-e12qt1"><!> <button class="action-btn-icon svelte-e12qt1" title="Copy Link"><span class="material-icons">link</span></button> <button class="dl-btn-premium svelte-e12qt1"><span class="material-icons">download</span> GET</button></div></div>'),Oa=c('<div class="search-results-list svelte-e12qt1"></div>'),Ya=c('<div class="pagination-container svelte-e12qt1"><button class="page-nav-btn svelte-e12qt1"><span class="material-icons">arrow_back</span></button> <div class="page-numbers"><span class="page-info svelte-e12qt1"> </span></div> <button class="page-nav-btn svelte-e12qt1"><span class="material-icons">arrow_forward</span></button></div>'),Ja=c('<div class="search-header-tools svelte-e12qt1"><div class="results-meta svelte-e12qt1"><span class="count svelte-e12qt1"> </span> <span class="label svelte-e12qt1">ASSETS DETECTED</span></div> <div class="view-toggle glass-panel svelte-e12qt1"><button title="Tactical Grid"><span class="material-icons">grid_view</span></button> <button title="Data List"><span class="material-icons">view_list</span></button></div></div> <div class="results-container"><!></div> <!>',1),Wa=c('<div class="search-viewport svelte-e12qt1"><!></div>');function nt(be,w){wa(w,!0);const G="/api";let k=f(""),b=f(!1),D=f(!1),Z=f(!0),H=f(fe([])),z=f(fe([])),me=f(fe([])),m=f(1),ee=10,ae=f(0),U=f(0),R=f("grid");function Ne(){const a=document.getElementById("header-dynamic-content");if(a){a.innerHTML=`
        <div style="display: flex; align-items: center; gap: 1.5rem; width: 100%;">
          <div class="search-bar-header" style="flex: 1; position: relative;">
            <span class="material-icons" style="position: absolute; left: 1rem; top: 50%; transform: translateY(-50%); color: var(--text-muted); pointer-events: none;">search</span>
            <input type="text" id="spotlight-search" 
              placeholder="Detecting file signatures across Fshare..." 
              style="width: 100%; padding: 0.75rem 1rem 0.75rem 3rem; background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1); border-radius: 12px; color: #fff; outline: none; transition: all 0.3s;"
              autocomplete="off">
          </div>
        </div>
      `;const t=document.getElementById("spotlight-search");t&&(t.addEventListener("keydown",_=>{if(_.key==="Enter"){const u=t.value.trim();u&&(v(k,u,!0),qe(u))}}),e(k)&&(t.value=e(k)),t.focus())}}ya(()=>{const a=new URLSearchParams(window.location.search).get("q");Ne(),a?(v(k,a,!0),qe(a)):je()});async function je(){v(b,!0);try{const a=await Ke.fetch("trending",async()=>{const t=await fetch(`${G}/discovery/trending`);if(!t.ok)throw new Error("Failed to fetch trending");return t.json()});v(me,Se(a.results||[]),!0),v(Z,!0),v(D,!1)}catch(a){console.error("Trending error:",a)}finally{v(b,!1)}}async function qe(a){if(a){v(m,1),v(D,!0),v(Z,!1),v(b,!0);try{const t=await Ke.fetch(`search:${a}`,async()=>{const _=await fetch(`${G}/search/enhanced?q=${encodeURIComponent(a)}&enrich=true`);if(!_.ok)throw new Error("Search failed");return _.json()});v(H,Se(t.results||[]),!0),te()}catch(t){console.error("Search error:",t),X.error("Neural link failure: Search connection lost"),v(H,[],!0),v(z,[],!0)}finally{v(b,!1)}}}function te(){v(ae,e(H).length,!0),v(U,Math.ceil(e(ae)/ee),!0);const a=(e(m)-1)*ee,t=a+ee;v(z,e(H).slice(a,t),!0)}function ye(a){e(R)!==a&&(v(R,a,!0),v(m,1),te())}function we(a){a<1||a>e(U)||(v(m,a,!0),te(),document.querySelector(".search-viewport")?.scrollTo({top:0,behavior:"smooth"}))}function Se(a){return a.map(t=>{const _=t.tmdb_title||t.parsed_name||t.name;let u=t.resolution,ie=t.source;return!u&&t.quality&&(t.quality.includes("2160")||t.quality.includes("4K")?u="4K":t.quality.includes("1080")?u="1080p":t.quality.includes("720")&&(u="720p")),{id:t.tmdb_id,title:_,posterPath:t.poster_path,posterUrl:t.poster_url,voteAverage:t.vote_average||0,releaseDate:t.release_date||t.first_air_date||t.year||"",mediaType:t.media_type||"movie",fcode:t.id,originalFilename:t.name,fileSize:t.size||0,score:0,quality:t.quality,resolution:u,source:ie,episodeTag:t.episode_tag,hasVietsub:t.vietsub||!1,hasVietdub:t.vietdub||!1}})}function Ge(a){if(a===0)return"0 B";const t=1024,_=["B","KB","MB","GB","TB"],u=Math.floor(Math.log(a)/Math.log(t));return parseFloat((a/Math.pow(t,u)).toFixed(2))+" "+_[u]}function He(a){return a?a==="4K"||a==="2160p"?"#ffd700":a==="1080p"?"#00ffa3":a==="720p"?"#00f3ff":"var(--text-muted)":"var(--text-muted)"}async function se(a){const t=await Ea.addDownload({url:`https://fshare.vn/file/${a.fcode}`});t.success?X.success("Initiating data retrieval"):X.error(t.error||"Neural link failure: Download initiation failed")}function $e(a){navigator.clipboard.writeText(`https://fshare.vn/file/${a.fcode}`),X.success("Binary link copied to clipboard")}function Oe(a){Pa.openSmartSearch({tmdbId:String(a.id),type:a.mediaType,title:a.title,year:a.releaseDate?.substring(0,4)})}var re=Wa();Da("e12qt1",a=>{xa(()=>{Ta.title="Search - Flasharr"})});var Ye=l(re);{var Je=a=>{var t=Ma();j(1,t,()=>Ve),n(a,t)},We=a=>{var t=W(),_=N(t);{var u=M=>{var E=Ia(),$=d(l(E),2);_e($,21,()=>e(me),V=>V.fcode,(V,C)=>{var B=Ca(),A=l(B);Qe(A,Le(()=>e(C),{onDownload:()=>se(e(C))})),r(B),j(1,B,()=>he,()=>({y:20,duration:400})),n(V,B)}),r($),r(E),j(1,E,()=>Ve,()=>({duration:400})),n(M,E)},ie=M=>{var E=W(),$=N(E);{var V=C=>{var B=Ja(),A=N(B),oe=l(A),xe=l(oe),Xe=l(xe,!0);r(xe),ka(2),r(oe);var Te=d(oe,2),le=l(Te);let ke;le.__click=()=>ye("grid");var De=d(le,2);let Ee;De.__click=()=>ye("list"),r(Te),r(A);var ne=d(A,2),Ze=l(ne);{var ea=h=>{var S=za();n(h,S)},aa=h=>{var S=W(),L=N(S);{var Q=x=>{var g=Ra();_e(g,21,()=>e(z),P=>P.fcode,(P,o)=>{var q=Ua(),K=l(q);Qe(K,Le(()=>e(o),{onDownload:()=>se(e(o))})),r(q),j(1,q,()=>he,()=>({y:20,duration:300})),n(P,q)}),r(g),n(x,g)},O=x=>{var g=Oa();_e(g,21,()=>e(z),P=>P.fcode,(P,o)=>{var q=$a(),K=l(q),ra=l(K);{var ia=s=>{var i=Va();T(()=>ge(i,"src",`https://image.tmdb.org/t/p/w92${e(o).posterPath??""}`)),n(s,i)},oa=s=>{var i=W(),F=N(i);{var pe=I=>{var J=Aa();T(()=>ge(J,"src",e(o).posterUrl)),n(I,J)},ma=I=>{var J=La();n(I,J)};p(F,I=>{e(o).posterUrl?I(pe):I(ma,!1)},!0)}n(s,i)};p(ra,s=>{e(o).posterPath?s(ia):s(oa,!1)})}r(K);var ve=d(K,2),ce=l(ve),de=l(ce),la=l(de,!0);r(de);var Be=d(de,2),na=l(Be,!0);r(Be),r(ce);var Y=d(ce,2),va=l(Y,!0);r(Y);var Pe=d(Y,2),Fe=l(Pe);{var ca=s=>{var i=Qa(),F=l(i,!0);r(i),T(pe=>{Ba(i,`color: ${pe??""}`),y(F,e(o).resolution)},[()=>He(e(o).resolution)]),n(s,i)};p(Fe,s=>{e(o).resolution&&s(ca)})}var Me=d(Fe,2);{var da=s=>{var i=Ka(),F=l(i,!0);r(i),T(()=>y(F,e(o).source)),n(s,i)};p(Me,s=>{e(o).source&&s(da)})}var Ce=d(Me,2);{var ua=s=>{var i=Na(),F=l(i,!0);r(i),T(()=>y(F,e(o).episodeTag)),n(s,i)};p(Ce,s=>{e(o).episodeTag&&s(ua)})}var ue=d(Ce,2),pa=l(ue,!0);r(ue);var Ie=d(ue,2);{var fa=s=>{var i=ja();n(s,i)};p(Ie,s=>{e(o).hasVietsub&&s(fa)})}var _a=d(Ie,2);{var ha=s=>{var i=Ga();n(s,i)};p(_a,s=>{e(o).hasVietdub&&s(ha)})}r(Pe),r(ve);var ze=d(ve,2),Ue=l(ze);{var ga=s=>{var i=Ha();i.__click=()=>Oe(e(o)),n(s,i)};p(Ue,s=>{e(o).id&&s(ga)})}var Re=d(Ue,2);Re.__click=()=>$e(e(o));var ba=d(Re,2);ba.__click=()=>se(e(o)),r(ze),r(q),T((s,i)=>{y(la,e(o).title),y(na,s),ge(Y,"title",e(o).originalFilename),y(va,e(o).originalFilename),y(pa,i)},[()=>e(o).releaseDate?.substring(0,4),()=>Ge(e(o).fileSize)]),j(1,q,()=>he,()=>({x:-20,duration:300})),n(P,q)}),r(g),n(x,g)};p(L,x=>{e(R)==="grid"?x(Q):x(O,!1)},!0)}n(h,S)};p(Ze,h=>{e(z).length===0?h(ea):h(aa,!1)})}r(ne);var ta=d(ne,2);{var sa=h=>{var S=Ya(),L=l(S);L.__click=()=>we(e(m)-1);var Q=d(L,2),O=l(Q),x=l(O);r(O),r(Q);var g=d(Q,2);g.__click=()=>we(e(m)+1),r(S),T(()=>{L.disabled=e(m)===1,y(x,`${e(m)??""} / ${e(U)??""}`),g.disabled=e(m)===e(U)}),n(h,S)};p(ta,h=>{e(U)>1&&h(sa)})}T(()=>{y(Xe,e(ae)),ke=Ae(le,1,"toggle-btn svelte-e12qt1",null,ke,{active:e(R)==="grid"}),Ee=Ae(De,1,"toggle-btn svelte-e12qt1",null,Ee,{active:e(R)==="list"})}),n(C,B)};p($,C=>{e(D)&&C(V)},!0)}n(M,E)};p(_,M=>{e(Z)&&!e(D)?M(u):M(ie,!1)},!0)}n(a,t)};p(Ye,a=>{e(b)?a(Je):a(We,!1)})}r(re),n(be,re),Sa()}qa(["click"]);export{nt as component};
