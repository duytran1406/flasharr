version: '3.8'

services:
  flasharr:
    build:
      context: .
      dockerfile: Dockerfile
    image: flasharr:latest
    container_name: flasharr
    restart: unless-stopped
    
    ports:
      - "8484:8484"
    
    volumes:
      # AppData volume for persistence
      - ./appData:/appData
      
      # Optional: Separate downloads volume
      # - /path/to/downloads:/appData/downloads
    
    environment:
      # AppData directory
      - FLASHARR_APPDATA_DIR=/appData
      
      # Logging level
      - RUST_LOG=flasharr=info,tower_http=info
    
    # Optional: Resource limits
    # deploy:
    #   resources:
    #     limits:
    #       cpus: '2'
    #       memory: 512M
    #     reservations:
    #       cpus: '0.5'
    #       memory: 128M
    
    # Optional: Health check override
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8484/api/health"]
      interval: 30s
      timeout: 3s
      retries: 3
      start_period: 10s
    
    # Optional: Network configuration
    # networks:
    #   - flasharr-network

# Optional: Custom network
# networks:
#   flasharr-network:
#     driver: bridge

# Optional: Named volumes
# volumes:
#   flasharr-data:
#     driver: local
